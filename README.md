# AMR Task Controller

æœ¬å°ˆæ¡ˆç‚ºä¸€å¥—æ¨¡æ“¬ AMRï¼ˆè‡ªä¸»ç§»å‹•æ©Ÿå™¨äººï¼‰ä»»å‹™æ’ç¨‹ç³»çµ±çš„ç°¡æ˜“æ¡†æ¶ï¼Œæ¨¡æ“¬å¤šå€‹ client å‘ server ä¸¦ç™¼é€ä»»å‹™ï¼Œä¸¦é€é semaphore æ§åˆ¶å…±äº«è³‡æºçš„ä½¿ç”¨ä¸Šé™ï¼Œå…·å‚™ä»»å‹™å„ªå…ˆç´šä½‡åˆ—ã€dispatcherã€CLI æ¸¬è©¦è…³æœ¬èˆ‡ ncurses UIã€‚

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
amr_task_controller/
â”œâ”€â”€ include/            # æ¨™é ­æª”ï¼ˆjob_handler.h, task_queue.h, ui_ncurses.hï¼‰
â”œâ”€â”€ src/                # ç¨‹å¼åŸå§‹ç¢¼ï¼ˆmain.c, job_handler.c, task_queue.c, client.c, ui_ncurses.cï¼‰
â”œâ”€â”€ build/              # ç·¨è­¯è¼¸å‡ºæª”æ¡ˆï¼ˆserver, clientï¼‰
â”œâ”€â”€ assets/             # æˆªåœ–ç¤ºæ„ï¼ˆScreenShot.pngï¼‰
â”œâ”€â”€ run_clients.sh      # ä¸€éµæ¸¬è©¦è…³æœ¬ï¼ˆæ¨¡æ“¬å¤šå€‹ client ç™¼é€ä»»å‹™ï¼‰
â”œâ”€â”€ Makefile            # ç·¨è­¯è¦å‰‡
â””â”€â”€ README.md           # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
```

---

## ğŸš€ ä½¿ç”¨èªªæ˜

### ç·¨è­¯ç¨‹å¼

```bash
make
```

### å•Ÿå‹• Serverï¼ˆå« ncurses ä»»å‹™ç›£æ§ UIï¼‰

```bash
./build/server
```

### æ¨¡æ“¬å¤šå€‹ Client ç™¼é€ä»»å‹™

```bash
./run_clients.sh
```

å¯è‡ªè¨‚ç™¼é€æ–¹å¼ï¼ˆå–®ä¸€ clientï¼‰ï¼š
```bash
./build/client "REQUEST job=material_delivery; from=storage; to=station1; priority=2"
```

---

## ğŸ§  ä»»å‹™æ’ç¨‹é‚è¼¯èˆ‡è³‡æºè¨­å®š

- `cargo_sem`ï¼šæœ€å¤šå…è¨± **3** å€‹ Cargo ä»»å‹™ï¼ˆmaterial_delivery / intermediate_transferï¼‰åŒæ™‚åŸ·è¡Œã€‚
- `qc_sem`ï¼šæœ€å¤šå…è¨± **1** å€‹ QC ä»»å‹™ï¼ˆsample_collectionï¼‰åŒæ™‚åŸ·è¡Œã€‚
- Cargo ä»»å‹™æœƒé€²å…¥ **å„ªå…ˆç´šä½‡åˆ—**ï¼Œç”± **dispatcher thread** æŒ‰ç…§ priority æ’åºä¸¦ç™¼æ´¾åŸ·è¡Œã€‚

### ä»»å‹™é¡å‹èªªæ˜

| ä»»å‹™åç¨±               | æè¿°                             | ä½¿ç”¨ semaphore |
|------------------------|----------------------------------|----------------|
| `material_delivery`     | å°‡ç‰©æ–™å¾å€‰å„²å€é€è‡³å·¥ä½œç«™          | `cargo_sem`    |
| `intermediate_transfer` | åœ¨è£½ç¨‹å–®å…ƒé–“æ¬é‹åŠæˆå“            | `cargo_sem`    |
| `sample_collection`     | æ¡é›†æ¨£æœ¬è‡³ QC æª¢æ¸¬ç«™              | `qc_sem`       |

### ä»»å‹™è™•ç†æ¨¡æ“¬æµç¨‹

æ¯å€‹ä»»å‹™åœ¨è™•ç†éç¨‹ä¸­æœƒä½¿ç”¨ `sleep()` æ¨¡æ“¬åŸ·è¡Œæ™‚é–“ï¼Œä¸¦æ–¼çµ‚ç«¯é¡¯ç¤ºç‹€æ…‹ç´€éŒ„èˆ‡çµ±è¨ˆè€—æ™‚ã€‚

---

## ğŸ–¥ï¸ ä»»å‹™ç‹€æ…‹å³æ™‚ç›£æ§ï¼ˆUIï¼‰

Server å•Ÿå‹•å¾ŒæœƒåŒæ™‚å•Ÿå‹• **ncurses-based UI é¢æ¿**ï¼Œå¯è§€å¯Ÿ queue ä¸­ä»»å‹™çš„ï¼š

- ä»»å‹™ ID / Client ç·¨è™Ÿ / ä»»å‹™æ•˜è¿°
- ç‹€æ…‹ï¼ˆPending / Running / Doneï¼‰
- ç­‰å¾…æ™‚é–“èˆ‡åŸ·è¡Œæ™‚é–“

**æŒ‰ä¸‹ `q` å¯é›¢é–‹é¢æ¿**ã€‚

---

## âœ… å·²å¯¦ä½œåŠŸèƒ½

- [x] å¤šä»»å‹™é¡å‹ï¼ˆå«è³‡æºé™åˆ¶æ§åˆ¶ï¼‰
- [x] å„ªå…ˆç´šä»»å‹™ä½‡åˆ—èˆ‡ dispatcher ç®¡ç†
- [x] å¤š client æ¨¡æ“¬ï¼ˆè…³æœ¬ or å¤šçµ‚ç«¯å•Ÿå‹•ï¼‰
- [x] ncurses UI å³æ™‚ç›£æ§ä»»å‹™ç‹€æ…‹
- [x] è·¨ä¸»æ©Ÿé€£ç·šæ”¯æ´ï¼ˆClient å¯æŒ‡å®š IPï¼‰

---

## ğŸ› ï¸ å¯æ“´å……åŠŸèƒ½ï¼ˆé–‹ç™¼ä¸­ï¼‰

- [ ] **å®¹å™¨åŒ–ï¼ˆDockerï¼‰**ï¼šå°è£ server/clientï¼Œåˆ©æ–¼éƒ¨ç½²èˆ‡æ¸¬è©¦
- [ ] **å‰ç«¯ UI æ§åˆ¶å°ï¼ˆWeb-basedï¼‰**ï¼šæä¾›ç€è¦½å™¨å³æ™‚æ§åˆ¶èˆ‡ä»»å‹™æŸ¥è©¢

---

## ğŸ“· å¯¦éš›åŸ·è¡Œç•«é¢

![AMR UI Screenshot](assets/ScreenShot.png)

---

## ğŸ”– License

MIT License - feel free to use or modify for academic or research purposes.
